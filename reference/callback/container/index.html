<!doctype html><html lang=en-US><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>lexy/callback/container.hpp — lexy</title><style>:root{--white:white;--background-color:#fdfdfd;--default-color:#101010;--heading-color:#0A0A0A;--link-color:#2A2A2A;--gray-highlight-color:#aaaaaa;--highlight-color:#2861ce}@media(prefers-color-scheme:dark){:root{--white:#202020;--background-color:#222222;--default-color:#efefef;--heading-color:#f5f5f5;--link-color:#d5d5d5;--gray-highlight-color:#555555}}nav#menu div.menu-container,main{max-width:1250px;margin:0 auto;padding:0 10px}@media(min-width:800px){article{max-width:900px;padding:0 10px}}html{position:relative;min-height:100%;margin:0;padding:0}body{font-family:serif;font-size:18px;color:var(--default-color);background-color:var(--background-color);width:100%;padding:0;margin:0}main{margin-bottom:75px;display:flex;justify-content:center}h1,h2,h3,h4,h5,h6{font-family:sans-serif;font-weight:700;line-height:1.15em;color:var(--heading-color);margin:0 0 .4em;hyphens:auto}h1{font-size:2em}h2{font-size:1.75em}h3{font-size:1.5em}h4{font-size:1.25em}h5{font-size:1.15em}h6{font-size:1.1em}a,a svg,button svg{color:var(--link-color);fill:var(--link-color);stroke:var(--link-color);transition:color ease .3s}a:hover,button:hover{color:var(--highlight-color)}a:hover svg,button:hover svg{color:var(--highlight-color);fill:var(--highlight-color);stroke:var(--highlight-color)}a:focus,button:focus{outline:none}br{margin:1em}article{flex:1;min-width:0}article p,article ul,article ol,article dl,article td{hyphens:auto;text-align:justify}nav#menu{width:100%;padding:0;background-color:var(--white);border-bottom:2px solid var(--highlight-color);font-family:sans-serif;font-size:1.3em}nav#menu div.menu-container{display:flex}nav#menu div.menu-container ul{display:flex;flex-direction:row;align-items:center;padding:0;list-style:none}nav#menu div.menu-container ul li a{text-decoration:none}nav#menu div.menu-container ul li a svg{height:1em}nav#menu div.menu-container ul li a.active{border-width:0 0 2px;border-style:solid;border-color:var(--highlight-color)}nav#menu div.menu-container ul#home{padding-left:0;padding-right:10px}nav#menu div.menu-container ul#home .title{font-weight:700}nav#menu div.menu-container ul#main{margin-left:auto}nav#menu div.menu-container ul#main li{padding-left:20px}@media(max-width:600px){nav#menu div.menu-container ul#main{flex-direction:column;align-items:flex-end;margin:5px 10px 0 auto}}footer#page-footer{position:absolute;bottom:0;left:0;right:0;height:2em;display:flex;justify-content:space-between;font-size:.8em;font-weight:200;line-height:1em;border-top:1px solid #ccc}footer#page-footer section{padding-left:1em;padding-right:1em;padding-top:.5em;width:100%}footer#page-footer .copyright{text-align:left}footer#page-footer .poweredby{text-align:right}@media(max-width:450px){footer#page-footer{flex-direction:column;align-items:flex-start}footer#page-footer section{text-align:initial!important;width:initial}}aside.toc{display:none}@media(min-width:1100px){aside.toc{display:initial;position:sticky;top:0;min-width:200px;max-width:350px;padding-right:1em;align-self:flex-start;hyphens:auto}aside.toc header{margin-top:1em;font-weight:700}aside.toc ul{list-style:none;padding:0}aside.toc ul ul{padding-left:1em;padding-bottom:.2em}aside.toc ul li{padding-bottom:.2em}aside.toc a{text-decoration:none}}article form svg,article a svg,article i svg{height:1em;position:relative;top:2px;padding-right:3px}article p svg:not(:first-child){padding-left:.25em}article header{margin-top:1em;margin-bottom:1em}article header nav{display:flex;flex-wrap:wrap}article header nav a{text-decoration:none;padding-right:7px}@media(min-width:700px){article header nav form.search{margin-left:auto}}article header nav form.search input[type=search]{padding:2px;width:250px}article header nav form.search input[type=search]:focus{border-color:var(--highlight-color);outline:solid var(--highlight-color)1px}article header nav form.search button[type=submit]{margin-left:-25px;border:none;background:initial}article .lead p{font-weight:500;font-size:1.1em}article .admonitionblock{margin-bottom:1em}article .admonitionblock td.icon{font-weight:700}article .admonitionblock td.content div:first-child p{margin-top:0}article .admonitionblock td.content div:last-child p{margin-bottom:0}@media(max-width:600px){article .admonitionblock tr{display:block;float:left;padding-left:.5em;padding-right:.5em}article .admonitionblock tr td{display:block}}@media(min-width:600px){article .admonitionblock td.icon{width:75px;text-align:center;border-right:1px solid var(--gray-highlight-color)}article .admonitionblock td.content{padding-left:.5em}}article .exampleblock{margin-top:1em;margin-bottom:1em}article .exampleblock .title{font-style:italic}article a.github-example{text-decoration:none}article a.github-example svg{height:.8em;position:relative;top:2px}article .playground-example .title,article .godbolt-example .title{position:relative}article .playground-example .title a,article .godbolt-example .title a{position:absolute;top:7px;right:7px}article .playground-example .title a svg,article .godbolt-example .title a svg{height:1em}article details{margin-bottom:1em}article details summary{font-style:italic}article ul p,article ol p{margin:.2em}article div ul:not(:first-child),article div ol:not(:first-child){margin-top:0}article dl dt{margin-top:.5em;font-weight:700}article dl dd p,article dl dd div:only-child ul{margin:0;padding:0}article div dl:not(:first-child){margin-top:0}article table.tableblock{background:var(--white);margin:0 auto;border-collapse:collapse}article table.tableblock td,article table.tableblock th{border:1px solid var(--gray-highlight-color);padding:5px;text-align:left}article table.tableblock td p,article table.tableblock th p{margin:0}article div.sidebarblock{border:1px solid var(--gray-highlight-color);padding:.75em;margin:1em}article div.sidebarblock p{margin:0}article code{font-family:Inconsolata,monospace,sans-serif}article pre{margin-top:0;overflow:auto;padding:10px;background:var(--white);border:1px solid var(--gray-highlight-color);line-height:1.1}article .colist{margin-top:-.5em}article .colist ol{counter-reset:list}article .colist ol li{counter-increment:list;padding-left:1em}article .colist ol ::marker{content:"(" counter(list)")";font-weight:700}article .colist p{margin:0}.highlight .c,.highlight .cm,.highlight .cp,.highlight .c1,.highlight .cs,.ace_editor .c,.ace_editor .cm,.ace_editor .cp,.ace_editor .c1,.ace_editor .cs{color:#998;font-style:italic;font-weight:initial}.highlight .k,.highlight .kc,.highlight .kd,.highlight .kp,.highlight .kr,.highlight .kt,.highlight .ace_storage,.highlight .ace_keyword,.ace_editor .k,.ace_editor .kc,.ace_editor .kd,.ace_editor .kp,.ace_editor .kr,.ace_editor .kt,.ace_editor .ace_storage,.ace_editor .ace_keyword{color:#458;font-style:initial;font-weight:700}.highlight .o,.highlight .p,.highlight .ace_keyword.ace_operator,.highlight .ace_paren,.highlight .ace_punctuation,.ace_editor .o,.ace_editor .p,.ace_editor .ace_keyword.ace_operator,.ace_editor .ace_paren,.ace_editor .ace_punctuation{color:red;font-style:initial;font-weight:initial}.highlight .ace_dsl,.ace_editor .ace_dsl{pointer-events:auto}.highlight .m,.highlight .mf,.highlight .mh,.highlight .mi,.highlight .mo,.highlight .ace_constant,.ace_editor .m,.ace_editor .mf,.ace_editor .mh,.ace_editor .mi,.ace_editor .mo,.ace_editor .ace_constant{color:#ff8000;font-style:initial;font-weight:initial}.highlight .s,.highlight .sb,.highlight .sc,.highlight .sd,.highlight .s2,.highlight .s3,.highlight .sh,.highlight .si,.highlight .sx,.highlight .sr,.highlight .s1,.highlight .ss,.highlight .se,.highlight .ace_string,.ace_editor .s,.ace_editor .sb,.ace_editor .sc,.ace_editor .sd,.ace_editor .s2,.ace_editor .s3,.ace_editor .sh,.ace_editor .si,.ace_editor .sx,.ace_editor .sr,.ace_editor .s1,.ace_editor .ss,.ace_editor .se,.ace_editor .ace_string{color:green;font-style:initial;font-weight:initial}.highlight .cp,.highlight .cpf,.ace_editor .cp,.ace_editor .cpf{color:green;font-style:initial;font-weight:700}.highlight .err,.highlight .ace_invalid,.ace_editor .err,.ace_editor .ace_invalid{color:red;font-style:initial;font-weight:initial}.highlight strong,.ace_editor strong{font-weight:initial}.highlight strong:not(:empty)::before,.ace_editor strong:not(:empty)::before{content:"*";color:red}.highlight strong:not(:empty)::after,.ace_editor strong:not(:empty)::after{content:"*";color:red}</style></head><body><nav id=menu><div class=menu-container><ul id=home><li><a href=/><span class=title>lexy:</span> C++ parsing DSL</a></li></ul><ul id=main><li><a href=/learn/>Learn</a></li><li><a href=/reference/>Reference</a></li><li><a href=/playground/>Playground</a></li><li><a href=/download/>Download</a></li><li><a href=https://github.com/foonathan/lexy title=GitHub><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" class="svg-inline--fa fa-github fa-w-16" role="img" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></a></li></ul></div></nav><main><aside class=toc><header><a href=#>Table of Contents</a></header></aside><article id=doc><header><h1>Header <code>lexy/callback/container.hpp</code></h1><nav><a href=https://github.com/foonathan/lexy/blob/main/include/lexy/callback/container.hpp><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" class="svg-inline--fa fa-github fa-w-16" role="img" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> View source
</a><a href="https://github.com/foonathan/lexy/issues/new?title=lexy%2fcallback%2fcontainer.hpp"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="bug" class="svg-inline--fa fa-bug fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentcolor" d="M511.988 288.9c-.478 17.43-15.217 31.1-32.653 31.1H424v16c0 21.864-4.882 42.584-13.6 61.145l60.228 60.228c12.496 12.497 12.496 32.758.0 45.255-12.498 12.497-32.759 12.496-45.256.0l-54.736-54.736C345.886 467.965 314.351 480 280 480V236c0-6.627-5.373-12-12-12h-24c-6.627.0-12 5.373-12 12v244c-34.351.0-65.886-12.035-90.636-32.108l-54.736 54.736c-12.498 12.497-32.759 12.496-45.256.0-12.496-12.497-12.496-32.758.0-45.255l60.228-60.228C92.882 378.584 88 357.864 88 336v-16H32.666C15.23 320 .491 306.33.013 288.9-.484 270.816 14.028 256 32 256h56v-58.745l-46.628-46.628c-12.496-12.497-12.496-32.758.0-45.255 12.498-12.497 32.758-12.497 45.256.0L141.255 160h229.489l54.627-54.627c12.498-12.497 32.758-12.497 45.256.0 12.496 12.497 12.496 32.758.0 45.255L424 197.255V256h56c17.972.0 32.484 14.816 31.988 32.9zM257 0c-61.856.0-112 50.144-112 112h224C369 50.144 318.856.0 257 0z"/></svg> Report an issue
</a><a href=https://github.com/foonathan/lexy/edit/main/docs/content/reference/callback/container.adoc><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="edit" class="svg-inline--fa fa-edit fa-w-18" role="img" viewBox="0 0 576 512"><path fill="currentcolor" d="M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8.0zm162-22.9-48.8-48.8c-15.2-15.2-39.9-15.2-55.2.0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8.0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2.0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5.0 112v352c0 26.5 21.5 48 48 48h352c26.5.0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"/></svg> Edit this page</a><form class=search id=dsl-goto-form><input type=search id=dsl-goto-search placeholder="Go to..." list=dsl-goto-data autocomplete=off>
<button type=submit title=Go><svg viewBox="0 0 448 512"><path d="M438.6 278.6c12.5-12.5 12.5-32.8.0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3.0s-12.5 32.8.0 45.3L338.8 224H32c-17.7.0-32 14.3-32 32s14.3 32 32 32h306.7L233.4 393.4c-12.5 12.5-12.5 32.8.0 45.3s32.8 12.5 45.3.0l160-160z"/></svg></button></form></nav></header><section><div class="paragraph lead"><p>Callbacks and sinks for constructing containers.</p></div><div class=sect1><h2 id=as_list>Callback and sink <code>lexy::as_list</code> and <code>lexy::as_collection</code></h2><div class=sectionbody><div class=listingblock><div class=title><code>lexy/callback/container.hpp</code></div><div class=content><pre class="rouge highlight"><code data-lang=cpp><span class=k>namespace</span> <span class=n>lexy</span>
<span class=p>{</span>
    <span class=k>template</span> <span class=o>&lt;</span><span class=k>typename</span> <span class=nc>Container</span><span class=p>&gt;</span>
    <span class=k>struct</span> <span class=nc><em>as</em></span><em><span class=o>-</span><span class=n>container</span></em>
    <span class=p>{</span>
        <span class=c1>//=== callback ===//</span>
        <span class=k>using</span> <span class=n>return_type</span> <span class=o>=</span> <span class=n>Container</span><span class=p>;</span>

        <span class=k>constexpr</span> <span class=n>Container</span> <span class=k>operator</span><span class=p>()(</span><span class=n>lexy</span><span class=o>::</span><span class=n>nullopt</span><span class=p>)</span> <span class=k>const</span><span class=p>;</span>
        <span class=k>constexpr</span> <span class=n>Container</span> <span class=k>operator</span><span class=p>()(</span><span class=n>Container</span><span class=o>&amp;&amp;</span> <span class=n>container</span><span class=p>)</span> <span class=k>const</span><span class=p>;</span>

        <span class=k>template</span> <span class=o>&lt;</span><span class=k>typename</span> <span class=o>...</span> <span class=nc>Args</span><span class=p>&gt;</span>
        <span class=k>constexpr</span> <span class=n>Container</span> <span class=k>operator</span><span class=p>()(</span><span class=n>Args</span><span class=o>&amp;&amp;</span><span class=p>...</span> <span class=n>args</span><span class=p>)</span> <span class=k>const</span><span class=p>;</span>
        <span class=k>template</span> <span class=o>&lt;</span><span class=k>typename</span> <span class=o>...</span> <span class=nc>Args</span><span class=p>&gt;</span>
        <span class=k>constexpr</span> <span class=n>Container</span> <span class=k>operator</span><span class=p>()(</span><span class=k>const</span> <span class=n>Container</span><span class=o>::</span><span class=n>allocator_type</span><span class=o>&amp;</span> <span class=n>allocator</span><span class=p>,</span>
                                       <span class=n>Args</span><span class=o>&amp;&amp;</span><span class=p>...</span> <span class=n>args</span><span class=p>)</span> <span class=k>const</span><span class=p>;</span>

        <span class=c1>//=== sink ===//</span>
        <span class=k>struct</span> <span class=nc><em>sink</em></span><em><span class=o>-</span><span class=n>callback</span></em>
        <span class=p>{</span>
            <span class=k>using</span> <span class=n>return_type</span> <span class=o>=</span> <span class=n>Container</span><span class=p>;</span>

            <span class=k>template</span> <span class=o>&lt;</span><span class=k>typename</span> <span class=nc>T</span><span class=p>&gt;</span>
            <span class=k>constexpr</span> <span class=kt>void</span> <span class=k>operator</span><span class=p>()(</span><span class=n>T</span><span class=o>&amp;&amp;</span> <span class=n>obj</span><span class=p>);</span>

            <span class=k>template</span> <span class=o>&lt;</span><span class=k>typename</span> <span class=o>...</span> <span class=nc>Args</span><span class=p>&gt;</span>
            <span class=k>constexpr</span> <span class=kt>void</span> <span class=k>operator</span><span class=p>()(</span><span class=n>Args</span><span class=o>&amp;&amp;</span><span class=p>...</span> <span class=n>args</span><span class=p>);</span>

            <span class=k>constexpr</span> <span class=n>Container</span> <span class=n>finish</span><span class=p>()</span> <span class=o>&amp;&amp;</span><span class=p>;</span>
        <span class=p>};</span>

        <span class=k>constexpr</span> <span class=n><em>sink</em></span><em><span class=o>-</span><span class=n>callback</span></em> <span class=n>sink</span><span class=p>()</span> <span class=k>const</span><span class=p>;</span>
        <span class=k>constexpr</span> <span class=n><em>sink</em></span><em><span class=o>-</span><span class=n>callback</span></em> <span class=n>sink</span><span class=p>(</span><span class=k>const</span> <span class=n>Container</span><span class=o>::</span><span class=n>allocator_type</span><span class=o>&amp;</span> <span class=n>allocator</span><span class=p>)</span> <span class=k>const</span><span class=p>;</span>

        <span class=c1>//=== allocator ===//</span>
        <span class=k>template</span> <span class=o>&lt;</span><span class=k>typename</span> <span class=nc>AllocatorFn</span><span class=p>&gt;</span>
        <span class=k>constexpr</span> <span class=k>auto</span> <span class=n>allocator</span><span class=p>(</span><span class=n>AllocatorFn</span> <span class=n>allocator_fn</span><span class=p>)</span> <span class=k>const</span><span class=p>;</span>

        <span class=k>constexpr</span> <span class=k>auto</span> <span class=n>allocator</span><span class=p>()</span> <span class=k>const</span>
        <span class=p>{</span>
            <span class=k>return</span> <span class=n>allocator</span><span class=p>(</span><span class=n><em>identity</em></span><em><span class=o>-</span><span class=n>fn</span></em><span class=p>);</span>
        <span class=p>}</span>
    <span class=p>};</span>

    <span class=k>template</span> <span class=o>&lt;</span><span class=k>typename</span> <span class=nc>Container</span><span class=p>&gt;</span>
    <span class=k>constexpr</span> <span class=n><em>as</em></span><em><span class=o>-</span><span class=n>container</span></em><span class=o>&lt;</span><span class=n>Container</span><span class=o>&gt;</span> <span class=n>as_list</span><span class=p>;</span>

    <span class=k>template</span> <span class=o>&lt;</span><span class=k>typename</span> <span class=nc>Collection</span><span class=p>&gt;</span>
    <span class=k>constexpr</span> <span class=n><em>as</em></span><em><span class=o>-</span><span class=n>container</span></em><span class=o>&lt;</span><span class=n>Container</span><span class=o>&gt;</span> <span class=n>as_collection</span><span class=p>;</span>
<span class=p>}</span></code></pre></div></div><div class="paragraph lead"><p>Callbacks and sink to construct the given <code>Container</code>.</p></div><div class=paragraph><p><code>as_list</code> is used for positional containers like <code>std::vector</code>.
It calls <code>.push_back()</code> and <code>.emplace_back()</code>.
<code>as_collection</code> is used for non-positional containers like <code>std::set</code>.
It calls <code>.insert()</code> and <code>.emplace()</code>.</p></div><div class=paragraph><p>As a callback, they have the following overloads:</p></div><div class=dlist><dl><dt class=hdlist1><code>(lexy::nullopt)</code></dt><dd><p>Returns an empty container by default constructing it.</p></dd><dt class=hdlist1><code>(Container&& container)</code></dt><dd><p>Forwards an existing container unchanged.</p></dd><dt class=hdlist1><code>(Args&&…​ args)</code></dt><dd><p>Repeatedly calls <code>.push_back()</code>/<code>.insert()</code> on an empty container;
if called with <code>N</code> arguments, the resulting container will contain <code>N</code> items.
If <code>.reserve(sizeof…​(args))</code> is well-formed, calls that first.
The final container is returned.</p></dd><dt class=hdlist1><code>(const typename Container::allocator_type& allocator, Args&&…​ args)</code></dt><dd><p>Same as above, but constructs the empty container using the given <code>allocator</code>.</p></dd></dl></div><div class=paragraph><p>As a sink, <code>.sink()</code> can be called with zero arguments or with one argument of type <code>Container::allocator_type</code>.
In the first case, it default constructs an empty container.
In the second case, it constructs it using the allocator.
The resulting sink callback has the following overloads and returns the finished container:</p></div><div class=dlist><dl><dt class=hdlist1><code>(T&& object)</code></dt><dd><p>Calls <code>.push_back()</code>/<code>.insert()</code> on the container.</p></dd><dt class=hdlist1><code>(Args&&…​ args)</code></dt><dd><p>Calls <code>.emplace_back()</code>/<code>.emplace()</code> on the container.</p></dd></dl></div><div class=paragraph><p>The <code>.allocator()</code> function takes a function that obtains the allocator from the parse state.
If the function is not provided, it uses the parse state itself as the allocator.
It returns a new callback and sink that accepts the parse state.
It then has the same overloads and behaviors, except that it will always use the allocator obtained via the <code>allocator_fn</code> from the parse state.
As a callback, this behavior is similar to <a href=/reference/callback/bind/#bind><code>lexy::bind</code> </a> where the allocator is bound via <a href=/reference/callback/bind/#parse_state><code>lexy::parse_state</code> </a>.
As a sink, this behavior is similar to <a href=/reference/callback/bind/#bind_sink><code>lexy::bind_sink</code> </a> where the allocator is bound via <a href=/reference/callback/bind/#parse_state><code>lexy::parse_state</code> </a>.</p></div><div class=exampleblock><div class=title>Example 1. Construct a list of integers</div><div class=content><div class="listingblock godbolt-example"><div class=title><a href="https://godbolt.org/clientstate/eyJzZXNzaW9ucyI6W3siY29tcGlsZXJzIjpbXSwiZXhlY3V0b3JzIjpbeyJjb21waWxlciI6eyJpZCI6ImNsYW5nX3RydW5rIiwibGlicyI6W3siaWQiOiJsZXh5IiwidmVyc2lvbiI6InRydW5rIn1dLCJvcHRpb25zIjoiLXN0ZD1jKysyMCJ9LCJzdGRpbiI6IjEsIDIsIDMiLCJzdGRpblZpc2libGUiOnRydWV9XSwiaWQiOjEsImxhbmd1YWdlIjoiYysrIiwic291cmNlIjoiI2luY2x1ZGUgXHUwMDNjdmVjdG9yXHUwMDNlXG5cbiNpbmNsdWRlIFx1MDAzY2xleHkvYWN0aW9uL3BhcnNlLmhwcFx1MDAzZVxuI2luY2x1ZGUgXHUwMDNjbGV4eS9jYWxsYmFjay5ocHBcdTAwM2VcbiNpbmNsdWRlIFx1MDAzY2xleHkvZHNsLmhwcFx1MDAzZVxuI2luY2x1ZGUgXHUwMDNjbGV4eV9leHQvY29tcGlsZXJfZXhwbG9yZXIuaHBwXHUwMDNlXG4jaW5jbHVkZSBcdTAwM2NsZXh5X2V4dC9yZXBvcnRfZXJyb3IuaHBwXHUwMDNlXG5cbm5hbWVzcGFjZSBkc2wgPSBsZXh5Ojpkc2w7XG5cbnN0cnVjdCBwcm9kdWN0aW9uXG57XG4gICAgc3RhdGljIGNvbnN0ZXhwciBhdXRvIHdoaXRlc3BhY2UgPSBkc2w6OmFzY2lpOjpzcGFjZTtcblxuICAgIHN0YXRpYyBjb25zdGV4cHIgYXV0byBydWxlID0gW10ge1xuICAgICAgICBhdXRvIGludGVnZXIgPSBkc2w6OmludGVnZXJcdTAwM2NpbnRcdTAwM2U7XG4gICAgICAgIHJldHVybiBkc2w6Omxpc3QoaW50ZWdlciwgZHNsOjpzZXAoZHNsOjpjb21tYSkpO1xuICAgIH0oKTtcblxuICAgIHN0YXRpYyBjb25zdGV4cHIgYXV0byB2YWx1ZSA9IGxleHk6OmFzX2xpc3RcdTAwM2NzdGQ6OnZlY3Rvclx1MDAzY2ludFx1MDAzZVx1MDAzZTtcbn07XG5cbmludCBtYWluKClcbntcbiAgICBhdXRvIGlucHV0ICA9IGxleHlfZXh0Ojpjb21waWxlcl9leHBsb3Jlcl9pbnB1dCgpO1xuICAgIGF1dG8gcmVzdWx0ID0gbGV4eTo6cGFyc2VcdTAwM2Nwcm9kdWN0aW9uXHUwMDNlKGlucHV0LCBsZXh5X2V4dDo6cmVwb3J0X2Vycm9yKTtcbiAgICBpZiAoIXJlc3VsdClcbiAgICAgICAgcmV0dXJuIDE7XG5cbiAgICBzdGQ6OnByaW50ZihcIm51bWJlcnM6IFwiKTtcbiAgICBmb3IgKGF1dG8gaSA6IHJlc3VsdC52YWx1ZSgpKVxuICAgICAgICBzdGQ6OnByaW50ZihcIiVkIFwiLCBpKTtcbiAgICBzdGQ6OnB1dGNoYXIoJ1xcbicpO1xufSJ9XX0=" , title="Try it online"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="play" class="svg-inline--fa fa-play fa-w-14" role="img" viewBox="0 0 448 512"><path fill="currentcolor" d="M424.4 214.7 72.4 6.6C43.8-10.3.0 6.1.0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1.0-82.6z"/></svg></a></div><div class=content><pre class="rouge highlight"><code data-lang=cpp><span class=k>struct</span> <span class=nc>production</span>
<span class=p>{</span>
    <span class=k>static</span> <span class=k>constexpr</span> <span class=k>auto</span> <span class=n>whitespace</span> <span class=o>=</span> <span class=n>dsl</span><span class=o>::</span><span class=n>ascii</span><span class=o>::</span><span class=n>space</span><span class=p>;</span>

    <span class=k>static</span> <span class=k>constexpr</span> <span class=k>auto</span> <span class=n>rule</span> <span class=o>=</span> <span class=p>[]</span> <span class=p>{</span>
        <span class=k>auto</span> <span class=n>integer</span> <span class=o>=</span> <span class=n>dsl</span><span class=o>::</span><span class=n>integer</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>;</span>
        <span class=k>return</span> <span class=n>dsl</span><span class=o>::</span><span class=n>list</span><span class=p>(</span><span class=n>integer</span><span class=p>,</span> <span class=n>dsl</span><span class=o>::</span><span class=n>sep</span><span class=p>(</span><span class=n>dsl</span><span class=o>::</span><span class=n>comma</span><span class=p>));</span>
    <span class=p>}();</span>

    <span class=k>static</span> <span class=k>constexpr</span> <span class=k>auto</span> <span class=n>value</span> <span class=o>=</span> <span class=n>lexy</span><span class=o>::</span><span class=n>as_list</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span><span class=p>;</span>
<span class=p>};</span></code></pre></div></div></div></div><div class=exampleblock><div class=title>Example 2. Construct a list of integers with a custom allocator</div><div class=content><div class="listingblock godbolt-example"><div class=title><a href="https://godbolt.org/clientstate/eyJzZXNzaW9ucyI6W3siY29tcGlsZXJzIjpbXSwiZXhlY3V0b3JzIjpbeyJjb21waWxlciI6eyJpZCI6ImNsYW5nX3RydW5rIiwibGlicyI6W3siaWQiOiJsZXh5IiwidmVyc2lvbiI6InRydW5rIn1dLCJvcHRpb25zIjoiLXN0ZD1jKysyMCJ9LCJzdGRpbiI6IiIsInN0ZGluVmlzaWJsZSI6ZmFsc2V9XSwiaWQiOjEsImxhbmd1YWdlIjoiYysrIiwic291cmNlIjoiI2luY2x1ZGUgXHUwMDNjdmVjdG9yXHUwMDNlXG5cbiNpbmNsdWRlIFx1MDAzY2xleHkvYWN0aW9uL3BhcnNlLmhwcFx1MDAzZVxuI2luY2x1ZGUgXHUwMDNjbGV4eS9jYWxsYmFjay5ocHBcdTAwM2VcbiNpbmNsdWRlIFx1MDAzY2xleHkvZHNsLmhwcFx1MDAzZVxuI2luY2x1ZGUgXHUwMDNjbGV4eV9leHQvY29tcGlsZXJfZXhwbG9yZXIuaHBwXHUwMDNlXG4jaW5jbHVkZSBcdTAwM2NsZXh5X2V4dC9yZXBvcnRfZXJyb3IuaHBwXHUwMDNlXG5cbm5hbWVzcGFjZSBkc2wgPSBsZXh5Ojpkc2w7XG5cbnN0cnVjdCBzdGF0ZVxue1xuICAgIHN0ZDo6YWxsb2NhdG9yXHUwMDNjaW50XHUwMDNlIGFsbG9jYXRvcjsgLy8gVGhlIGFsbG9jYXRvciB0aGF0IHNob3VsZCBiZSB1c2VkLlxuICAgIC8vIFBvdGVudGlhbGx5IG90aGVyIG1lbWJlcnMgaGVyZS5cbn07XG5cbnN0cnVjdCBwcm9kdWN0aW9uXG57XG4gICAgc3RhdGljIGNvbnN0ZXhwciBhdXRvIHdoaXRlc3BhY2UgPSBkc2w6OmFzY2lpOjpzcGFjZTtcblxuICAgIHN0YXRpYyBjb25zdGV4cHIgYXV0byBydWxlID0gW10ge1xuICAgICAgICBhdXRvIGludGVnZXIgPSBkc2w6OmludGVnZXJcdTAwM2NpbnRcdTAwM2U7XG4gICAgICAgIHJldHVybiBkc2w6Omxpc3QoaW50ZWdlciwgZHNsOjpzZXAoZHNsOjpjb21tYSkpO1xuICAgIH0oKTtcblxuICAgIHN0YXRpYyBjb25zdGV4cHIgYXV0byB2YWx1ZVxuICAgICAgICAvLyBQYXNzIHRoZSBhbGxvY2F0b3IgdG8gdGhlIHNpbmsuXG4gICAgICAgID0gbGV4eTo6YXNfbGlzdFx1MDAzY3N0ZDo6dmVjdG9yXHUwMDNjaW50XHUwMDNlXHUwMDNlLmFsbG9jYXRvcihcdTAwMjZzdGF0ZTo6YWxsb2NhdG9yKTtcbn07XG5cbmludCBtYWluKClcbntcbiAgICBhdXRvIGlucHV0ICA9IGxleHlfZXh0Ojpjb21waWxlcl9leHBsb3Jlcl9pbnB1dCgpO1xuICAgIGF1dG8gcmVzdWx0ID0gbGV4eTo6cGFyc2VcdTAwM2Nwcm9kdWN0aW9uXHUwMDNlKGlucHV0LCBzdGF0ZSgpLCBsZXh5X2V4dDo6cmVwb3J0X2Vycm9yKTtcbiAgICBpZiAoIXJlc3VsdClcbiAgICAgICAgcmV0dXJuIDE7XG5cbiAgICBzdGQ6OnByaW50ZihcIm51bWJlcnM6IFwiKTtcbiAgICBmb3IgKGF1dG8gaSA6IHJlc3VsdC52YWx1ZSgpKVxuICAgICAgICBzdGQ6OnByaW50ZihcIiVkIFwiLCBpKTtcbiAgICBzdGQ6OnB1dGNoYXIoJ1xcbicpO1xufSJ9XX0=" , title="Try it online"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="play" class="svg-inline--fa fa-play fa-w-14" role="img" viewBox="0 0 448 512"><path fill="currentcolor" d="M424.4 214.7 72.4 6.6C43.8-10.3.0 6.1.0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1.0-82.6z"/></svg></a></div><div class=content><pre class="rouge highlight"><code data-lang=cpp><span class=k>struct</span> <span class=nc>state</span>
<span class=p>{</span>
    <span class=n>std</span><span class=o>::</span><span class=n>allocator</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>allocator</span><span class=p>;</span> <span class=c1>// The allocator that should be used.</span>
    <span class=c1>// Potentially other members here.</span>
<span class=p>};</span>

<span class=k>struct</span> <span class=nc>production</span>
<span class=p>{</span>
    <span class=k>static</span> <span class=k>constexpr</span> <span class=k>auto</span> <span class=n>whitespace</span> <span class=o>=</span> <span class=n>dsl</span><span class=o>::</span><span class=n>ascii</span><span class=o>::</span><span class=n>space</span><span class=p>;</span>

    <span class=k>static</span> <span class=k>constexpr</span> <span class=k>auto</span> <span class=n>rule</span> <span class=o>=</span> <span class=p>[]</span> <span class=p>{</span>
        <span class=k>auto</span> <span class=n>integer</span> <span class=o>=</span> <span class=n>dsl</span><span class=o>::</span><span class=n>integer</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>;</span>
        <span class=k>return</span> <span class=n>dsl</span><span class=o>::</span><span class=n>list</span><span class=p>(</span><span class=n>integer</span><span class=p>,</span> <span class=n>dsl</span><span class=o>::</span><span class=n>sep</span><span class=p>(</span><span class=n>dsl</span><span class=o>::</span><span class=n>comma</span><span class=p>));</span>
    <span class=p>}();</span>

    <span class=k>static</span> <span class=k>constexpr</span> <span class=k>auto</span> <span class=n>value</span>
        <span class=c1>// Pass the allocator to the sink.</span>
        <span class=o>=</span> <span class=n>lexy</span><span class=o>::</span><span class=n>as_list</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span><span class=p>.</span><span class=n>allocator</span><span class=p>(</span><span class=o>&amp;</span><span class=n>state</span><span class=o>::</span><span class=n>allocator</span><span class=p>);</span>
<span class=p>};</span></code></pre></div></div></div></div></div></div><div class=sect1><h2 id=concat>Callback and sink <code>lexy::concat</code></h2><div class=sectionbody><div class=listingblock><div class=title><code>lexy/callback/container.hpp</code></div><div class=content><pre class="rouge highlight"><code data-lang=cpp><span class=k>namespace</span> <span class=n>lexy</span>
<span class=p>{</span>
    <span class=k>template</span> <span class=o>&lt;</span><span class=k>typename</span> <span class=nc>Container</span><span class=p>&gt;</span>
    <span class=k>struct</span> <span class=nc><em>concat</em></span><em><span class=o>-</span><span class=n>impl</span></em>
    <span class=p>{</span>
        <span class=k>using</span> <span class=n>return_type</span> <span class=o>=</span> <span class=n>Container</span><span class=p>;</span>

        <span class=k>constexpr</span> <span class=n>Container</span> <span class=k>operator</span><span class=p>()()</span> <span class=k>const</span><span class=p>;</span>
        <span class=k>constexpr</span> <span class=n>Container</span> <span class=k>operator</span><span class=p>()(</span><span class=n>lexy</span><span class=o>::</span><span class=n>nullopt</span><span class=p>)</span> <span class=k>const</span><span class=p>;</span>
        <span class=k>constexpr</span> <span class=n>Container</span> <span class=k>operator</span><span class=p>()(</span><span class=n>Container</span><span class=o>&amp;&amp;</span> <span class=n>head</span><span class=p>,</span> <span class=n>Container</span><span class=o>&amp;&amp;</span><span class=p>...</span> <span class=n>tail</span><span class=p>)</span> <span class=k>const</span><span class=p>;</span>

        <span class=k>constexpr</span> <span class=n><em>sink</em></span> <span class=k>auto</span> <span class=n>sink</span><span class=p>()</span> <span class=k>const</span><span class=p>;</span>
    <span class=p>};</span>

    <span class=k>template</span> <span class=o>&lt;</span><span class=k>typename</span> <span class=nc>Container</span><span class=p>&gt;</span>
    <span class=k>constexpr</span> <span class=n><em>concat</em></span><em><span class=o>-</span><span class=n>impl</span></em> <span class=n>concat</span><span class=p>;</span>
<span class=p>}</span></code></pre></div></div><div class="paragraph lead"><p>Callback and sink that concatenates multiple containers.</p></div><div class=paragraph><p>As a callback, it accepts zero or more existing containers, and will concatenate them together.
This is done by repeatedly calling <code>.append()</code> or <code>.push_back()</code> on the first container.</p></div><div class=paragraph><p>As a sink, it creates a default constructed container object as the current result.
It can then be invoked with a single container object.
If the current result is still empty, the new container is move assigned into it.
Otherwise, the new container is appended by calling <code>.append()</code> or <code>.push_back()</code>.</p></div><div class=exampleblock><div class=title>Example 3. Construct a list of integers from a list of list of integers</div><div class=content><div class="listingblock godbolt-example"><div class=title><a href=https://godbolt.org/clientstate/eyJzZXNzaW9ucyI6W3siY29tcGlsZXJzIjpbXSwiZXhlY3V0b3JzIjpbeyJjb21waWxlciI6eyJpZCI6ImNsYW5nX3RydW5rIiwibGlicyI6W3siaWQiOiJsZXh5IiwidmVyc2lvbiI6InRydW5rIn1dLCJvcHRpb25zIjoiLXN0ZD1jKysyMCJ9LCJzdGRpbiI6IjEsIDIsIDNcbjQsIDUsIDZcbjcsIDgsIDkiLCJzdGRpblZpc2libGUiOnRydWV9XSwiaWQiOjEsImxhbmd1YWdlIjoiYysrIiwic291cmNlIjoiI2luY2x1ZGUgXHUwMDNjdmVjdG9yXHUwMDNlXG5cbiNpbmNsdWRlIFx1MDAzY2xleHkvYWN0aW9uL3BhcnNlLmhwcFx1MDAzZVxuI2luY2x1ZGUgXHUwMDNjbGV4eS9jYWxsYmFjay5ocHBcdTAwM2VcbiNpbmNsdWRlIFx1MDAzY2xleHkvZHNsLmhwcFx1MDAzZVxuI2luY2x1ZGUgXHUwMDNjbGV4eV9leHQvY29tcGlsZXJfZXhwbG9yZXIuaHBwXHUwMDNlXG4jaW5jbHVkZSBcdTAwM2NsZXh5X2V4dC9yZXBvcnRfZXJyb3IuaHBwXHUwMDNlXG5cbm5hbWVzcGFjZSBkc2wgPSBsZXh5Ojpkc2w7XG5cbnN0cnVjdCBsaXN0XG57XG4gICAgc3RhdGljIGNvbnN0ZXhwciBhdXRvIHJ1bGUgPSBbXSB7XG4gICAgICAgIGF1dG8gaW50ZWdlciA9IGRzbDo6aW50ZWdlclx1MDAzY2ludFx1MDAzZTtcbiAgICAgICAgcmV0dXJuIGRzbDo6bGlzdChpbnRlZ2VyLCBkc2w6OnNlcChkc2w6OmNvbW1hKSk7XG4gICAgfSgpO1xuXG4gICAgc3RhdGljIGNvbnN0ZXhwciBhdXRvIHZhbHVlID0gbGV4eTo6YXNfbGlzdFx1MDAzY3N0ZDo6dmVjdG9yXHUwMDNjaW50XHUwMDNlXHUwMDNlO1xufTtcblxuc3RydWN0IHByb2R1Y3Rpb25cbntcbiAgICBzdGF0aWMgY29uc3RleHByIGF1dG8gd2hpdGVzcGFjZSA9IGRzbDo6YXNjaWk6OnNwYWNlO1xuICAgIHN0YXRpYyBjb25zdGV4cHIgYXV0byBydWxlICAgICAgID0gZHNsOjpsaXN0KGRzbDo6cFx1MDAzY2xpc3RcdTAwM2UsIGRzbDo6c2VwKGRzbDo6bmV3bGluZSkpO1xuICAgIHN0YXRpYyBjb25zdGV4cHIgYXV0byB2YWx1ZSAgICAgID0gbGV4eTo6Y29uY2F0XHUwMDNjc3RkOjp2ZWN0b3JcdTAwM2NpbnRcdTAwM2VcdTAwM2U7XG59O1xuXG5pbnQgbWFpbigpXG57XG4gICAgYXV0byBpbnB1dCAgPSBsZXh5X2V4dDo6Y29tcGlsZXJfZXhwbG9yZXJfaW5wdXQoKTtcbiAgICBhdXRvIHJlc3VsdCA9IGxleHk6OnBhcnNlXHUwMDNjcHJvZHVjdGlvblx1MDAzZShpbnB1dCwgbGV4eV9leHQ6OnJlcG9ydF9lcnJvcik7XG4gICAgaWYgKCFyZXN1bHQpXG4gICAgICAgIHJldHVybiAxO1xuXG4gICAgc3RkOjpwcmludGYoXCJudW1iZXJzOiBcIik7XG4gICAgZm9yIChhdXRvIGkgOiByZXN1bHQudmFsdWUoKSlcbiAgICAgICAgc3RkOjpwcmludGYoXCIlZCBcIiwgaSk7XG4gICAgc3RkOjpwdXRjaGFyKCdcXG4nKTtcbn0ifV19 , title="Try it online"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="play" class="svg-inline--fa fa-play fa-w-14" role="img" viewBox="0 0 448 512"><path fill="currentcolor" d="M424.4 214.7 72.4 6.6C43.8-10.3.0 6.1.0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1.0-82.6z"/></svg></a></div><div class=content><pre class="rouge highlight"><code data-lang=cpp><span class=k>struct</span> <span class=nc>list</span>
<span class=p>{</span>
    <span class=k>static</span> <span class=k>constexpr</span> <span class=k>auto</span> <span class=n>rule</span> <span class=o>=</span> <span class=p>[]</span> <span class=p>{</span>
        <span class=k>auto</span> <span class=n>integer</span> <span class=o>=</span> <span class=n>dsl</span><span class=o>::</span><span class=n>integer</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>;</span>
        <span class=k>return</span> <span class=n>dsl</span><span class=o>::</span><span class=n>list</span><span class=p>(</span><span class=n>integer</span><span class=p>,</span> <span class=n>dsl</span><span class=o>::</span><span class=n>sep</span><span class=p>(</span><span class=n>dsl</span><span class=o>::</span><span class=n>comma</span><span class=p>));</span>
    <span class=p>}();</span>

    <span class=k>static</span> <span class=k>constexpr</span> <span class=k>auto</span> <span class=n>value</span> <span class=o>=</span> <span class=n>lexy</span><span class=o>::</span><span class=n>as_list</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span><span class=p>;</span>
<span class=p>};</span>

<span class=k>struct</span> <span class=nc>production</span>
<span class=p>{</span>
    <span class=k>static</span> <span class=k>constexpr</span> <span class=k>auto</span> <span class=n>whitespace</span> <span class=o>=</span> <span class=n>dsl</span><span class=o>::</span><span class=n>ascii</span><span class=o>::</span><span class=n>space</span><span class=p>;</span>
    <span class=k>static</span> <span class=k>constexpr</span> <span class=k>auto</span> <span class=n>rule</span>       <span class=o>=</span> <span class=n>dsl</span><span class=o>::</span><span class=n>list</span><span class=p>(</span><span class=n>dsl</span><span class=o>::</span><span class=n>p</span><span class=o>&lt;</span><span class=n>list</span><span class=o>&gt;</span><span class=p>,</span> <span class=n>dsl</span><span class=o>::</span><span class=n>sep</span><span class=p>(</span><span class=n>dsl</span><span class=o>::</span><span class=n>newline</span><span class=p>));</span>
    <span class=k>static</span> <span class=k>constexpr</span> <span class=k>auto</span> <span class=n>value</span>      <span class=o>=</span> <span class=n>lexy</span><span class=o>::</span><span class=n>concat</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span><span class=p>;</span>
<span class=p>};</span></code></pre></div></div></div></div></div></div><div class=sect1><h2 id=collect>Sink <code>lexy::collect</code></h2><div class=sectionbody><div class=listingblock><div class=title><code>lexy/callback/container.hpp</code></div><div class=content><pre class="rouge highlight"><code data-lang=cpp><span class=k>namespace</span> <span class=n>lexy</span>
<span class=p>{</span>
    <span class=k>constexpr</span> <span class=n><em>sink</em></span><span class=o>&lt;&gt;</span> <span class=k>auto</span> <span class=n>collect</span><span class=p>(</span><span class=n><em>callback</em></span> <span class=k>auto</span><span class=o>&amp;&amp;</span> <span class=n>callback</span><span class=p>)</span>
        <span class=k>requires</span> <span class=n>std</span><span class=o>::</span><span class=n>is_void_v</span><span class=o>&lt;</span><span class=n><em>callback</em></span><em><span class=o>-</span><span class=k>return</span><span class=o>-</span><span class=n>type</span></em><span class=o>&gt;</span><span class=p>;</span>

    <span class=k>template</span> <span class=o>&lt;</span><span class=k>typename</span> <span class=nc>Container</span><span class=p>&gt;</span>
    <span class=k>constexpr</span> <span class=n><em>sink</em></span><span class=o>&lt;&gt;</span> <span class=k>auto</span> <span class=n>collect</span><span class=p>(</span><span class=n><em>callback</em></span> <span class=k>auto</span><span class=o>&amp;&amp;</span> <span class=n>callback</span><span class=p>);</span>
        <span class=k>requires</span> <span class=o>!</span><span class=n>std</span><span class=o>::</span><span class=n>is_void_v</span><span class=o>&lt;</span><span class=n><em>callback</em></span><em><span class=o>-</span><span class=k>return</span><span class=o>-</span><span class=n>type</span></em><span class=o>&gt;</span><span class=p>;</span>
<span class=p>}</span></code></pre></div></div><div class="paragraph lead"><p>Turns a callback into a sink by collecting all results.</p></div><div class=paragraph><p>The first overload requires that the <code>callback</code> returns <code>void</code>.
It returns a sink that repeatedly invokes <code>callback</code> and produces the number of invocations as a <code>std::size_t</code>.</p></div><div class=paragraph><p>The second overload requires that the <code>callback</code> does not return <code>void</code>.
<code>.sink()</code> can be called with zero arguments or with one argument of type <code>Container::allocator_type</code>.
In the first case, it default constructs an empty container; in the second case, it constructs it using the allocator.
The sink callback just forwards to <code>callback</code> and adds the result to the container by calling <code>.push_back()</code>.
The final container is returned.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><div class=title>Note</div></td><td class=content>See <a href=/reference/callback/adapter/#callback><code>lexy::callback</code> </a> for the inverse operation that turns a sink into a callback.</td></tr></tbody></table></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><div class=title>Tip</div></td><td class=content>Use <code>collect</code> for the error callback. It will collect all errors into a single container.</td></tr></tbody></table></div></div></div></section><section id=see-also><h2>See also</h2><ul><li><a href=/reference/callback/bind/#bind><code>lexy::bind</code></a></li><li><a href=/reference/callback/bind/#bind_sink><code>lexy::bind_sink</code></a></li><li><a href=/reference/callback/adapter/#callback><code>lexy::callback</code></a></li><li><a href=/reference/callback/bind/#parse_state><code>lexy::parse_state</code></a></li></ul></section></article><datalist id=dsl-goto-data></datalist>
<script>window.addEventListener("load",async function(){var e=await(await fetch("/reference/index.json")).json(),n=document.getElementById("dsl-goto-data"),s=document.getElementById("dsl-goto-form"),t=document.getElementById("dsl-goto-search");for(let t in e){let s=document.createElement("option");t.startsWith("lexy_")?s.value=t.toUpperCase():s.value=t,n.appendChild(s)}s.addEventListener("submit",function(n){n.preventDefault();let s=e[t.value.toLowerCase()];return s?window.location.href=s:t.value="",!1})})</script></main><footer id=page-footer><section class=copyright>&copy; <a target=_blank href=https://github.com/foonathan/lexy/blob/main/LICENSE title=License>2020-2025 Jonathan Müller and lexy contributors</a></section><section class=poweredby>Made with <a target=_blank href=https://gohugo.io>Hugo</a> and <a target=_blank href=https://fontawesome.com/license>Font Awesome</a>.</section></footer></body></html>